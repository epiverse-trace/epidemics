<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Modelling parameter uncertainty • epidemics</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modelling parameter uncertainty">
<meta name="robots" content="noindex">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">epidemics</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/epidemics.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modelling interventions</h6></li>
    <li><a class="dropdown-item" href="../articles/modelling_interventions.html">Getting started with modelling interventions targeting social contacts</a></li>
    <li><a class="dropdown-item" href="../articles/modelling_multiple_interventions.html">Modelling overlapping and sequential interventions targeting social contacts</a></li>
    <li><a class="dropdown-item" href="../articles/modelling_rate_interventions.html">Modelling interventions that change infection parameters</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modelling vaccination</h6></li>
    <li><a class="dropdown-item" href="../articles/modelling_vaccination.html">Modelling the effect of a vaccination campaign</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modelling seasonality</h6></li>
    <li><a class="dropdown-item" href="../articles/modelling_time_dependence.html">Modelling time-dependence and seasonality in transmission dynamics</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Run models with multiple populations</h6></li>
    <li><a class="dropdown-item" href="../articles/modelling_populations.html">Modelling in multiple populations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced modelling</h6></li>
    <li><a class="dropdown-item" href="../articles/modelling_param_uncertainty.html">Modelling parameter uncertainty</a></li>
    <li><a class="dropdown-item" href="../articles/modelling_scenarios.html">Modelling intervention scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/finalsize_comparison.html">Reducing parameters required for final size estimation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides to library models</h6></li>
    <li><a class="dropdown-item" href="../articles/model_vacamole.html">Modelling leaky vaccination and hospitalisation outcomes with Vacamole</a></li>
    <li><a class="dropdown-item" href="../articles/model_ebola.html">Modelling responses to a stochastic Ebola virus epidemic</a></li>
    <li><a class="dropdown-item" href="../articles/model_diphtheria.html">Modelling a diphtheria outbreak in a humanitarian camp setting</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides for developers</h6></li>
    <li><a class="dropdown-item" href="../articles/design-principles.html">Design principles for epidemics</a></li>
    <li><a class="dropdown-item" href="../articles/developer-walkthrough.html">Guide to developing epidemics features</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/epidemics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Modelling parameter uncertainty</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/epidemics/blob/main/vignettes/modelling_param_uncertainty.Rmd" class="external-link"><code>vignettes/modelling_param_uncertainty.Rmd</code></a></small>
      <div class="d-none name"><code>modelling_param_uncertainty.Rmd</code></div>
    </div>

    
    
<div class="alert alert-warning">
<p><strong>New to <em>epidemics</em>?</strong> It may help to read the
<a href="epidemics.html">“Get started”</a> vignette first!</p>
</div>
<p>This vignette shows how <em>epidemics</em> can conveniently be used
to include parameter uncertainty in an epidemic model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># epi modelling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/epidemics" class="external-link">epidemics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mrc-ide/EpiEstim" class="external-link">EpiEstim</a></span><span class="op">)</span> <span class="co"># for Rt estimation</span></span>
<span></span>
<span><span class="co"># data manipulation packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://colorspace.R-Forge.R-project.org/" class="external-link">colorspace</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># for reproducibility</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://withr.r-lib.org" class="external-link">withr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="modelling-parameter-uncertainty">Modelling parameter uncertainty<a class="anchor" aria-label="anchor" href="#modelling-parameter-uncertainty"></a>
</h2>
<p>Uncertainty in the characteristics of an epidemic is a key element
and roadblock in epidemic response <span class="citation">(<a href="#ref-shea2020">Shea et al. 2020</a>)</span>. Epidemic dynamics can
be influenced by two main sources of uncertainty: intrinsic randomness
in the transmission process, and uncertain knowledge of the parameters
underlying the transmission process. Here we focus on the latter,
i.e. uncertainty in the input parameters of an epidemic model.</p>
<p><em>epidemics</em> model functions can accept numeric vectors for all
infection parameters; the model is run for each parameter combination
using the same population and other model components (interventions,
vaccinations) etc. This allows users to quickly obtain results for a
range of parameter values without having to repeatedly call
<code>model_*()</code> in a loop or similar; this iteration is performed
internally.</p>
<p>Some benefits of vectorising inputs:</p>
<ul>
<li><p>Inputs are checked all at once, rather than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
times for each element of the parameter vector — this improves
performance over manual iteration;</p></li>
<li><p>Model output is organised to make filtering by parameter values
and scenarios easier (more on this below).</p></li>
</ul>
<div class="alert alert-info">
<p><strong>Note that</strong> it is always possible to pass a single
value of any infection parameter. Single values may be referred to as
“scalar” values or “scalars”. Passing scalar infection parameters will
yield a simple table of the model “time”, “demography group”,
“compartment”, and “value”, for the number of individuals in each
demographic group in each compartment at each model time point.</p>
</div>
<p>Click on “Code” below to see the hidden code used to set up a
population in this vignette. For more details on how to define
populations and initial model conditions please see the <a href="epidemics.html">“Getting started with epidemic scenario modelling
components”</a> vignette. In brief, we model the U.K. population with
three age groups, 0 – 19, 20 – 39, &gt; 40, and social contacts
stratified by age.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load contact and population data from socialmixr::polymod</span></span>
<span><span class="va">polymod</span> <span class="op">&lt;-</span> <span class="fu">socialmixr</span><span class="fu">::</span><span class="va"><a href="https://epiforecasts.io/socialmixr/reference/polymod.html" class="external-link">polymod</a></span></span>
<span><span class="va">contact_data</span> <span class="op">&lt;-</span> <span class="fu">socialmixr</span><span class="fu">::</span><span class="fu"><a href="https://epiforecasts.io/socialmixr/reference/contact_matrix.html" class="external-link">contact_matrix</a></span><span class="op">(</span></span>
<span>  <span class="va">polymod</span>,</span>
<span>  countries <span class="op">=</span> <span class="st">"United Kingdom"</span>,</span>
<span>  age.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>  symmetric <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare contact matrix</span></span>
<span><span class="va">contact_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">contact_data</span><span class="op">$</span><span class="va">matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare the demography vector</span></span>
<span><span class="va">demography_vector</span> <span class="op">&lt;-</span> <span class="va">contact_data</span><span class="op">$</span><span class="va">demography</span><span class="op">$</span><span class="va">population</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">demography_vector</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># initial conditions</span></span>
<span><span class="va">initial_i</span> <span class="op">&lt;-</span> <span class="fl">1e-6</span></span>
<span><span class="va">initial_conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  S <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">initial_i</span>, E <span class="op">=</span> <span class="fl">0</span>, I <span class="op">=</span> <span class="va">initial_i</span>, R <span class="op">=</span> <span class="fl">0</span>, V <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># build for all age groups</span></span>
<span><span class="va">initial_conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="va">initial_conditions</span>,</span>
<span>  <span class="va">initial_conditions</span>,</span>
<span>  <span class="va">initial_conditions</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># assign rownames for clarity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">initial_conditions</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># UK population created from hidden code</span></span>
<span><span class="va">uk_population</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/population.html">population</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"UK"</span>,</span>
<span>  contact_matrix <span class="op">=</span> <span class="va">contact_matrix</span>,</span>
<span>  demography_vector <span class="op">=</span> <span class="va">demography_vector</span>,</span>
<span>  initial_conditions <span class="op">=</span> <span class="va">initial_conditions</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="obtaining-estimates-of-disease-transmission-rate">Obtaining estimates of disease transmission rate<a class="anchor" aria-label="anchor" href="#obtaining-estimates-of-disease-transmission-rate"></a>
</h3>
<p>For this example, we consider influenza with pandemic potential <span class="citation">(<a href="#ref-ghani2010">Ghani et al.
2010</a>)</span>, and prepare multiple samples of the estimated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>.
This reflects pandemic response scenarios in which
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
estimates always come with some uncertainty (due to limitations in the
data and estimation methods). Sampling from a distribution that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
is expected to follow allows us to better understand the extent of
variance in possible epidemic outcomes.</p>
<p>We obtain the probability distribution function (PDF) from the
distribution of the serial intervals; this is a Gamma distribution with
shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
= 2.622 and scale
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
= 0.957 <span class="citation">(<a href="#ref-ghani2010">Ghani et al.
2010</a>)</span>.</p>
<div class="alert alert-info">
<p>The <a href="https://epiverse-trace.github.io/epiparameter/" class="external-link">forthcoming
Epiverse package <em>epiparameter</em></a> is expected to make it
substantially easier to access and use epidemiological parameters, such
as the serial interval, reported in the literature, making it easier to
model scenarios differing in the intrinsic characteristics of the
pathogen causing the outbreak.</p>
</div>
<p>We use this PDF to estimate the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
of the 2009 influenza pandemic in the U.K., using <a href="https://cran.r-project.org/package=EpiEstim" class="external-link">the <em>EpiEstim</em>
package</a>. We use the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
estimate (the mean and standard deviation) from <em>EpiEstim</em> to
generate 100 samples of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>,
assuming that it is normally distributed. Users who are drawing
parameters with greater variance may wish to draw a larger number of
samples.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get 2009 influenza data for school in Pennsylvania</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Flu2009</span><span class="op">)</span></span>
<span><span class="va">flu_early_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Flu2009</span><span class="op">$</span><span class="va">incidence</span>, <span class="va">dates</span> <span class="op">&lt;</span> <span class="st">"2009-05-10"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get the PDF of the distribution of serial intervals</span></span>
<span><span class="va">serial_pdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">2.622</span>, scale <span class="op">=</span> <span class="fl">0.957</span><span class="op">)</span></span>
<span><span class="co"># ensure probabilities add up to 1 by normalising them by the sum</span></span>
<span><span class="va">serial_pdf</span> <span class="op">&lt;-</span> <span class="va">serial_pdf</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">serial_pdf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use EpiEstim to estimate R with uncertainty</span></span>
<span><span class="co"># Uses Gamma distribution by default</span></span>
<span><span class="va">output_R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/estimate_R.html" class="external-link">estimate_R</a></span><span class="op">(</span></span>
<span>  incid <span class="op">=</span> <span class="va">flu_early_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"non_parametric_si"</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/make_config.html" class="external-link">make_config</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>si_distr <span class="op">=</span> <span class="va">serial_pdf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot output to visualise</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">output_R</span>, <span class="st">"R"</span><span class="op">)</span></span></code></pre></div>
<p><img src="modelling_param_uncertainty_files/figure-html/unnamed-chunk-4-1.png" width="900"></p>
</div>
<div class="section level3">
<h3 id="passing-a-vector-of-transmission-rates">Passing a vector of transmission rates<a class="anchor" aria-label="anchor" href="#passing-a-vector-of-transmission-rates"></a>
</h3>
<p>Here, we generate 100 samples of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>,
and convert to the transmission rate (often denoted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>)
by dividing by the infectious period of 7 days.</p>
<p>Since <em>EpiEstim</em> estimates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">Rt</annotation></semantics></math>,
the instantaneous
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>,
we shall use the mean of the estimates over the time period, and the
mean of the standard deviation, as parameters for a distribution from
which to draw
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
samples for the model.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get mean mean and sd over time</span></span>
<span><span class="va">r_estimate_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">output_R</span><span class="op">$</span><span class="va">R</span><span class="op">$</span><span class="va">`Mean(R)`</span><span class="op">)</span></span>
<span><span class="va">r_estimate_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">output_R</span><span class="op">$</span><span class="va">R</span><span class="op">$</span><span class="va">`Std(R)`</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate 100 R samples</span></span>
<span><span class="va">r_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span></span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fl">100</span>, mean <span class="op">=</span> <span class="va">r_estimate_mean</span>, sd <span class="op">=</span> <span class="va">r_estimate_sd</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">infectious_period</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="va">r_samples</span> <span class="op">/</span> <span class="va">infectious_period</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pass the vector of transmissibilities to the argument `transmission_rate`</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_default.html">model_default</a></span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="va">beta</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">600</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># view the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="co">#&gt;    transmission_rate infectiousness_rate recovery_rate time_end param_set</span></span>
<span><span class="co">#&gt;                &lt;num&gt;               &lt;num&gt;         &lt;num&gt;    &lt;num&gt;     &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:         0.1977482                 0.5     0.1428571      600         1</span></span>
<span><span class="co">#&gt; 2:         0.2333557                 0.5     0.1428571      600         2</span></span>
<span><span class="co">#&gt; 3:         0.1885540                 0.5     0.1428571      600         3</span></span>
<span><span class="co">#&gt; 4:         0.2954036                 0.5     0.1428571      600         4</span></span>
<span><span class="co">#&gt; 5:         0.2397671                 0.5     0.1428571      600         5</span></span>
<span><span class="co">#&gt; 6:         0.1892204                 0.5     0.1428571      600         6</span></span>
<span><span class="co">#&gt;         population intervention vaccination time_dependence increment scenario</span></span>
<span><span class="co">#&gt;             &lt;list&gt;       &lt;list&gt;      &lt;list&gt;          &lt;list&gt;     &lt;num&gt;    &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1: &lt;population[4]&gt;       [NULL]      [NULL]       &lt;list[1]&gt;         1        1</span></span>
<span><span class="co">#&gt; 2: &lt;population[4]&gt;       [NULL]      [NULL]       &lt;list[1]&gt;         1        1</span></span>
<span><span class="co">#&gt; 3: &lt;population[4]&gt;       [NULL]      [NULL]       &lt;list[1]&gt;         1        1</span></span>
<span><span class="co">#&gt; 4: &lt;population[4]&gt;       [NULL]      [NULL]       &lt;list[1]&gt;         1        1</span></span>
<span><span class="co">#&gt; 5: &lt;population[4]&gt;       [NULL]      [NULL]       &lt;list[1]&gt;         1        1</span></span>
<span><span class="co">#&gt; 6: &lt;population[4]&gt;       [NULL]      [NULL]       &lt;list[1]&gt;         1        1</span></span>
<span><span class="co">#&gt;                    data</span></span>
<span><span class="co">#&gt;                  &lt;list&gt;</span></span>
<span><span class="co">#&gt; 1: &lt;data.table[9015x4]&gt;</span></span>
<span><span class="co">#&gt; 2: &lt;data.table[9015x4]&gt;</span></span>
<span><span class="co">#&gt; 3: &lt;data.table[9015x4]&gt;</span></span>
<span><span class="co">#&gt; 4: &lt;data.table[9015x4]&gt;</span></span>
<span><span class="co">#&gt; 5: &lt;data.table[9015x4]&gt;</span></span>
<span><span class="co">#&gt; 6: &lt;data.table[9015x4]&gt;</span></span></code></pre></div>
<p>The output is a nested <code>&lt;data.table&gt;</code>, with the
output of each run of the model for each unique
<code>transmission_rate</code> contained as a
<code>&lt;data.frame&gt;</code> in the list column
<code>"data"</code>.</p>
</div>
<div class="section level3 alert alert-info">
<h3 id="output-type-for-vector-parameter-inputs">Output type for vector parameter inputs<a class="anchor" aria-label="anchor" href="#output-type-for-vector-parameter-inputs"></a>
</h3>
<p>The output of <code>model_*()</code> when an infection parameter is
passed as a vector is a nested <code>&lt;data.table&gt;</code>. This is
similar to a nested <code>&lt;tibble&gt;</code>, and can be handled by
popular data science packages, such as from the Tidyverse.</p>
<p>More on handling nested data can be found in this <a href="https://r4ds.hadley.nz/rectangling.html#list-columns" class="external-link">section on
list-columns in R for Data Science</a> and in the <a href="https://tidyr.tidyverse.org/articles/nest.html" class="external-link">documentation for
nested data in the <em>tidyr</em> package</a>. Equivalent operations are
possible on <code>&lt;data.table&gt;</code>s directly; see <a href="https://www.r-bloggers.com/2019/10/much-faster-unnesting-with-data-table/" class="external-link">this
R Bloggers post on unnesting data</a>.</p>
</div>
<p>We unnest the output’s “data” column in order to plot incidence
curves for each transmission rate value.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select the parameter set and data columns with dplyr::select()</span></span>
<span><span class="co"># add the R value for visualisation</span></span>
<span><span class="co"># calculate new infections, and use tidyr to unnest the data column</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">output</span>, <span class="va">param_set</span>, <span class="va">transmission_rate</span>, <span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    r_value <span class="op">=</span> <span class="va">r_samples</span>,</span>
<span>    new_infections <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">new_infections</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">new_infections</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot the data</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">new_infections</span>, col <span class="op">=</span> <span class="va">r_value</span>, group <span class="op">=</span> <span class="va">param_set</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># use qualitative scale to emphasize differences</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_fermenter</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"Dark2"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"R"</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"New infections"</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_comma</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">1e-3</span>, suffix <span class="op">=</span> <span class="st">"K"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time (days since start of epidemic)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">demography_group</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="modelling_param_uncertainty_files/figure-html/unnamed-chunk-8-1.png" alt="Incidence curves for the number of new infections on each day of the epidemic given uncertainty in the R estimate; colours indicate $R$ bins. Larger $R$ values lead to shorter epidemics with higher peaks, while lower R values lead to more spread out epidemics with lower peaks. Epidemics with $R$ &lt; 1.0 do not 'take off' and are not clearly visible. Linking incidence curves to their $R$ values in a plot allows a quick visual assessment of the potential outcomes of an epidemic whose $R$ is uncertain." width="900"><p class="caption">
Incidence curves for the number of new infections on each day of the
epidemic given uncertainty in the R estimate; colours indicate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
bins. Larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
values lead to shorter epidemics with higher peaks, while lower R values
lead to more spread out epidemics with lower peaks. Epidemics with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
&lt; 1.0 do not ‘take off’ and are not clearly visible. Linking
incidence curves to their
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
values in a plot allows a quick visual assessment of the potential
outcomes of an epidemic whose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
is uncertain.
</p>
</div>
<div class="section level3 alert alert-info">
<h3 id="passing-parameter-sets">Passing parameter sets<a class="anchor" aria-label="anchor" href="#passing-parameter-sets"></a>
</h3>
<p><em>epidemics</em> model functions can accept multiple infection
parameters as vectors, so long as any vectors are all of the same
length, or of length 1 (scalar values) as shown below.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, <span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span></span>
<span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, <span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span> <span class="co"># the recovery rate</span></span>
<span></span>
<span><span class="fu"><a href="../reference/model_default.html">model_default</a></span><span class="op">(</span></span>
<span>  <span class="va">population</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="va">beta</span>, <span class="co"># same length as gamma</span></span>
<span>  infectiousness_rate <span class="op">=</span> <span class="fl">0.5</span>, <span class="co"># length 1</span></span>
<span>  recovery_rate <span class="op">=</span> <span class="va">gamma</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="passing-vectors-of-epidemic-duration">Passing vectors of epidemic duration<a class="anchor" aria-label="anchor" href="#passing-vectors-of-epidemic-duration"></a>
</h3>
<p><em>epidemics</em> allows the duration of an model run to be varied,
as this may be useful when examining how variation in the start time of
an epidemic affects outcomes by a fixed end point. This example shows
how to estimate potential variation in the final epidemic size over a
range of epidemic start times (and hence durations, assuming a fixed
end).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># draw samples of time_end</span></span>
<span><span class="va">max_time</span> <span class="op">&lt;-</span> <span class="fl">600</span></span>
<span><span class="va">duration</span> <span class="op">&lt;-</span> <span class="va">max_time</span> <span class="op">-</span> <span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">1</span>, <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="fl">0.02</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># view durations</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">duration</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Epidemic duration"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Count"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="modelling_param_uncertainty_files/figure-html/unnamed-chunk-10-1.png" width="900"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pass the vector of durations to `time_end`</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_default.html">model_default</a></span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  time_end <span class="op">=</span> <span class="va">duration</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># view the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="co">#&gt;    transmission_rate infectiousness_rate recovery_rate time_end param_set</span></span>
<span><span class="co">#&gt;                &lt;num&gt;               &lt;num&gt;         &lt;num&gt;    &lt;num&gt;     &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:         0.1857143                 0.5     0.1428571      589         1</span></span>
<span><span class="co">#&gt; 2:         0.1857143                 0.5     0.1428571      595         2</span></span>
<span><span class="co">#&gt; 3:         0.1857143                 0.5     0.1428571      568         3</span></span>
<span><span class="co">#&gt; 4:         0.1857143                 0.5     0.1428571      583         4</span></span>
<span><span class="co">#&gt; 5:         0.1857143                 0.5     0.1428571      589         5</span></span>
<span><span class="co">#&gt; 6:         0.1857143                 0.5     0.1428571      593         6</span></span>
<span><span class="co">#&gt;         population intervention vaccination time_dependence increment scenario</span></span>
<span><span class="co">#&gt;             &lt;list&gt;       &lt;list&gt;      &lt;list&gt;          &lt;list&gt;     &lt;num&gt;    &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1: &lt;population[4]&gt;       [NULL]      [NULL]       &lt;list[1]&gt;         1        1</span></span>
<span><span class="co">#&gt; 2: &lt;population[4]&gt;       [NULL]      [NULL]       &lt;list[1]&gt;         1        1</span></span>
<span><span class="co">#&gt; 3: &lt;population[4]&gt;       [NULL]      [NULL]       &lt;list[1]&gt;         1        1</span></span>
<span><span class="co">#&gt; 4: &lt;population[4]&gt;       [NULL]      [NULL]       &lt;list[1]&gt;         1        1</span></span>
<span><span class="co">#&gt; 5: &lt;population[4]&gt;       [NULL]      [NULL]       &lt;list[1]&gt;         1        1</span></span>
<span><span class="co">#&gt; 6: &lt;population[4]&gt;       [NULL]      [NULL]       &lt;list[1]&gt;         1        1</span></span>
<span><span class="co">#&gt;                    data</span></span>
<span><span class="co">#&gt;                  &lt;list&gt;</span></span>
<span><span class="co">#&gt; 1: &lt;data.table[8850x4]&gt;</span></span>
<span><span class="co">#&gt; 2: &lt;data.table[8940x4]&gt;</span></span>
<span><span class="co">#&gt; 3: &lt;data.table[8535x4]&gt;</span></span>
<span><span class="co">#&gt; 4: &lt;data.table[8760x4]&gt;</span></span>
<span><span class="co">#&gt; 5: &lt;data.table[8850x4]&gt;</span></span>
<span><span class="co">#&gt; 6: &lt;data.table[8910x4]&gt;</span></span></code></pre></div>
<div class="alert alert-warning">
<p><strong>NOTE:</strong> When the duration of the model runs is varied,
each model output will have a potentially distinct number of rows.</p>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the epidemic size to view the mean and SD of sizes</span></span>
<span><span class="va">epidemic_size_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">output</span>, <span class="va">param_set</span>, <span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    size <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>        demography_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">demography_group</span><span class="op">)</span>,</span>
<span>        size <span class="op">=</span> <span class="fu"><a href="../reference/epidemic_size.html">epidemic_size</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="va">size</span>, .fns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="st">"demography_group"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># view the range of epidemic sizes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">epidemic_size_estimates</span><span class="op">$</span><span class="va">size</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  Inf -Inf</span></span></code></pre></div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-ghani2010" class="csl-entry">
Ghani, Azra, Marc Baguelin, Jamie Griffin, Stefan Flasche, Albert Jan
Van Hoek, Simon Cauchemez, Christl Donnelly, et al. 2010. <span>“The
Early Transmission Dynamics of H1N1pdm Influenza in the United
Kingdom.”</span> <em>PLoS Currents</em> 1 (June): RRN1130. <a href="https://doi.org/10.1371/currents.RRN1130" class="external-link">https://doi.org/10.1371/currents.RRN1130</a>.
</div>
<div id="ref-shea2020" class="csl-entry">
Shea, Katriona, Ottar N. Bjørnstad, Martin Krzywinski, and Naomi Altman.
2020. <span>“Uncertainty and the Management of Epidemics.”</span>
<em>Nature Methods</em> 17 (9): 867–68. <a href="https://doi.org/10.1038/s41592-020-0943-4" class="external-link">https://doi.org/10.1038/s41592-020-0943-4</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pratik Gupte, Rosalind Eggo, Edwin Van Leeuwen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3. Theme provided by <a href="https://github.com/epiverse-trace/epiversetheme" class="external-link">epiversetheme</a> 0.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
