<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Modelling intervention scenarios • epidemics</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modelling intervention scenarios">
<meta name="robots" content="noindex">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">epidemics</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/epidemics.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modelling interventions</h6></li>
    <li><a class="dropdown-item" href="../articles/modelling_interventions.html">Getting started with modelling interventions targeting social contacts</a></li>
    <li><a class="dropdown-item" href="../articles/modelling_multiple_interventions.html">Modelling overlapping and sequential interventions targeting social contacts</a></li>
    <li><a class="dropdown-item" href="../articles/modelling_rate_interventions.html">Modelling interventions that change infection parameters</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modelling vaccination</h6></li>
    <li><a class="dropdown-item" href="../articles/modelling_vaccination.html">Modelling the effect of a vaccination campaign</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modelling seasonality</h6></li>
    <li><a class="dropdown-item" href="../articles/modelling_time_dependence.html">Modelling time-dependence and seasonality in transmission dynamics</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Run models with multiple populations</h6></li>
    <li><a class="dropdown-item" href="../articles/modelling_populations.html">Modelling in multiple populations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced modelling</h6></li>
    <li><a class="dropdown-item" href="../articles/modelling_param_uncertainty.html">Modelling parameter uncertainty</a></li>
    <li><a class="dropdown-item" href="../articles/modelling_scenarios.html">Modelling intervention scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/finalsize_comparison.html">Reducing parameters required for final size estimation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides to library models</h6></li>
    <li><a class="dropdown-item" href="../articles/model_vacamole.html">Modelling leaky vaccination and hospitalisation outcomes with Vacamole</a></li>
    <li><a class="dropdown-item" href="../articles/model_ebola.html">Modelling responses to a stochastic Ebola virus epidemic</a></li>
    <li><a class="dropdown-item" href="../articles/model_diphtheria.html">Modelling a diphtheria outbreak in a humanitarian camp setting</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides for developers</h6></li>
    <li><a class="dropdown-item" href="../articles/design-principles.html">Design principles for epidemics</a></li>
    <li><a class="dropdown-item" href="../articles/developer-walkthrough.html">Guide to developing epidemics features</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/epidemics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Modelling intervention scenarios</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/epidemics/blob/main/vignettes/modelling_scenarios.Rmd" class="external-link"><code>vignettes/modelling_scenarios.Rmd</code></a></small>
      <div class="d-none name"><code>modelling_scenarios.Rmd</code></div>
    </div>

    
    
<p>Scenario modelling can guide epidemic response measures by helping to
establish general principles around the potential effects of
interventions, or</p>
<blockquote>
<p>… how might things change if policies are brought in …</p>
<p>– <a href="https://www.gov.uk/government/publications/epidemiological-modelling-frequently-asked-questions/epidemiological-modelling-frequently-asked-questions" class="external-link">UK
Scientific Advisory Group for Emergencies Epidemiological Modelling
FAQ</a></p>
</blockquote>
<p>Scenarios differ from true forecasts in projecting much farther ahead
(typically months rather than days), and large-scale scenario modelling
that includes both pharmaceutical and non-pharmaceutical interventions
was widely adopted during the Covid-19 pandemic and has been applied to
endemic infections as well <span class="citation">(<a href="#ref-howerton2023">Howerton et al. 2023</a>; <a href="#ref-prasad2023">Prasad et al. 2023</a>)</span>.</p>
<p>This vignettes shows how <em>epidemics</em> can be used to tun
multiple scenarios of epidemic response measures, and include parameter
uncertainty when running multiple scenarios.</p>
<div class="alert alert-warning">
<p><strong>New to modelling interventions using
<em>epidemics</em>?</strong> It may help to read these vignettes
first:</p>
<ul>
<li>
<a href="modelling_interventions.html">“Getting started with
modelling interventions targeting social contacts”</a>;</li>
<li>
<a href="modelling_multiple_interventions.html">“Modelling
overlapping and sequential interventions targeting social
contacts”</a>;</li>
<li>
<a href="modelling_rate_interventions.html">“Modelling interventions
that change infection parameters”</a>;</li>
<li>
<a href="modelling_vaccination.html">“Modelling the effect of a
vaccination campaign”</a>.</li>
</ul>
</div>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># epi modelling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/epidemics" class="external-link">epidemics</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># data manipulation packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://colorspace.R-Forge.R-project.org/" class="external-link">colorspace</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/" class="external-link">ggdist</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># for reproducibility</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://withr.r-lib.org" class="external-link">withr</a></span><span class="op">)</span></span></code></pre></div>
<p><em>epidemics</em> model functions can accept lists of intervention
sets and vaccination regimes, allowing multiple intervention,
vaccination, and combined intervention-and-vaccination sets to be
modelled on the same population.</p>
<p>Some benefits of passing lists of composable elements:</p>
<ul>
<li><p>Combinations of intervention and vaccination scenarios can be
conveniently created, as model functions will automatically create all
possible combinations of the arguments to <code>intervention</code> and
<code>vaccination</code>;</p></li>
<li><p>Input-checking and cross-checking is reduced by checking each
element of the <code>intervention</code> and <code>vaccination</code>
list independently before the combination is created (and against the
<code>population</code>, for cross-checking); hence for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
intervention sets and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
vaccination regimes there are only
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>+</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">N+M</annotation></semantics></math>
cross-checks, rather than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">N \times M</annotation></semantics></math>
cross-checks;</p></li>
<li><p>Model output is organised to provide a scenario identifier,
making subsetting easier (more on this below).</p></li>
</ul>
<div class="alert alert-warning">
<p>It may help to read the <a href="modelling_interventions.html">“Modelling a non-pharmaceutical
intervention targeting social contacts”</a> and the <a href="modelling_vaccination.html">“Modelling the effect of a vaccination
campaign”</a> vignettes first!</p>
</div>
<div class="section level3 alert alert-info">
<h3 id="which-model-components-can-be-passed-as-lists">Which model components can be passed as lists<a class="anchor" aria-label="anchor" href="#which-model-components-can-be-passed-as-lists"></a>
</h3>
<p><em>epidemics</em> currently offers the ability to pass
<strong>intervention sets</strong> and <strong>vaccination
regimes</strong> as lists.</p>
<p>It is not currently possible to pass lists of <em>populations</em>,
<em>seasonality</em>, or <em>population changes</em> to any models.</p>
<p>In future, it may be possible to pass multiple populations as a list,
to rapidly and conveniently model an epidemic on different populations,
or to examine the effect of assumptions about the population’s social
contacts or demographic structure.</p>
</div>
<div class="section level3">
<h3 id="setting-up-the-epidemic-context">Setting up the epidemic context<a class="anchor" aria-label="anchor" href="#setting-up-the-epidemic-context"></a>
</h3>
<p>We model an influenza epidemic in the U.K. population while
separating outcomes into three age groups, 0 – 19, 20 – 39, &gt; 40,
with social contacts stratified by age. Click on “Code” below to see the
hidden code used to set up a population in this vignette. For more
details on how to define populations and initial model conditions please
see the <a href="epidemics.html">“Getting started with epidemic scenario
modelling components”</a> vignette.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load contact and population data from socialmixr::polymod</span></span>
<span><span class="va">polymod</span> <span class="op">&lt;-</span> <span class="fu">socialmixr</span><span class="fu">::</span><span class="va"><a href="https://epiforecasts.io/socialmixr/reference/polymod.html" class="external-link">polymod</a></span></span>
<span><span class="va">contact_data</span> <span class="op">&lt;-</span> <span class="fu">socialmixr</span><span class="fu">::</span><span class="fu"><a href="https://epiforecasts.io/socialmixr/reference/contact_matrix.html" class="external-link">contact_matrix</a></span><span class="op">(</span></span>
<span>  <span class="va">polymod</span>,</span>
<span>  countries <span class="op">=</span> <span class="st">"United Kingdom"</span>,</span>
<span>  age.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>  symmetric <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare contact matrix</span></span>
<span><span class="va">contact_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">contact_data</span><span class="op">$</span><span class="va">matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare the demography vector</span></span>
<span><span class="va">demography_vector</span> <span class="op">&lt;-</span> <span class="va">contact_data</span><span class="op">$</span><span class="va">demography</span><span class="op">$</span><span class="va">population</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">demography_vector</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># initial conditions</span></span>
<span><span class="va">initial_i</span> <span class="op">&lt;-</span> <span class="fl">1e-6</span></span>
<span><span class="va">initial_conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  S <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">initial_i</span>, E <span class="op">=</span> <span class="fl">0</span>, I <span class="op">=</span> <span class="va">initial_i</span>, R <span class="op">=</span> <span class="fl">0</span>, V <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># build for all age groups</span></span>
<span><span class="va">initial_conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="va">initial_conditions</span>,</span>
<span>  <span class="va">initial_conditions</span>,</span>
<span>  <span class="va">initial_conditions</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># assign rownames for clarity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">initial_conditions</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># UK population created from hidden code</span></span>
<span><span class="va">uk_population</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/population.html">population</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"UK"</span>,</span>
<span>  contact_matrix <span class="op">=</span> <span class="va">contact_matrix</span>,</span>
<span>  demography_vector <span class="op">=</span> <span class="va">demography_vector</span>,</span>
<span>  initial_conditions <span class="op">=</span> <span class="va">initial_conditions</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creating-a-list-of-intervention-sets">Creating a list of intervention sets<a class="anchor" aria-label="anchor" href="#creating-a-list-of-intervention-sets"></a>
</h3>
<p>We shall create a list of ‘intervention sets’, each set representing
a scenario of epidemic response measures.</p>
<p><strong>Note that</strong> each intervention set is simply a list of
<code>&lt;intervention&gt;</code> objects; typically, a single
<code>&lt;contacts_intervention&gt;</code> and any
<code>&lt;rate_interventions&gt;</code> on infection parameters.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_time</span> <span class="op">&lt;-</span> <span class="fl">600</span></span>
<span><span class="co"># prepare durations as starting at 25% of the way through an epidemic</span></span>
<span><span class="co"># and ending halfway through</span></span>
<span><span class="va">time_begin</span> <span class="op">&lt;-</span> <span class="va">max_time</span> <span class="op">/</span> <span class="fl">4</span></span>
<span><span class="va">time_end</span> <span class="op">&lt;-</span> <span class="va">max_time</span> <span class="op">/</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># create three distinct contact interventions</span></span>
<span><span class="co"># prepare an intervention that models school closures for 180 days</span></span>
<span><span class="va">close_schools</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/intervention.html">intervention</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"School closure"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"contacts"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="va">time_begin</span>,</span>
<span>  time_end <span class="op">=</span> <span class="va">time_end</span>,</span>
<span>  reduction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare an intervention which mostly affects adults 20 -- 65</span></span>
<span><span class="va">close_workplaces</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/intervention.html">intervention</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Workplace closure"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"contacts"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="va">time_begin</span>,</span>
<span>  time_end <span class="op">=</span> <span class="va">time_end</span>,</span>
<span>  reduction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.3</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare a combined intervention</span></span>
<span><span class="va">combined_intervention</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">close_schools</span>, <span class="va">close_workplaces</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a mask-mandate rate intervention</span></span>
<span><span class="co"># prepare an intervention that models mask mandates for 300 days</span></span>
<span><span class="va">mask_mandate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/intervention.html">intervention</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"mask mandate"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"rate"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="va">time_begin</span>,</span>
<span>  time_end <span class="op">=</span> <span class="va">time_end</span>,</span>
<span>  reduction <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Having prepared the interventions, we create intervention sets, and
pass them to a model function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create intervention sets, which are combinations of contacts and rate</span></span>
<span><span class="co"># interventions</span></span>
<span><span class="va">intervention_scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  scenario_01 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    contacts <span class="op">=</span> <span class="va">close_schools</span></span>
<span>  <span class="op">)</span>,</span>
<span>  scenario_02 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    contacts <span class="op">=</span> <span class="va">close_workplaces</span></span>
<span>  <span class="op">)</span>,</span>
<span>  scenario_03 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    contacts <span class="op">=</span> <span class="va">combined_intervention</span></span>
<span>  <span class="op">)</span>,</span>
<span>  scenario_04 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    transmission_rate <span class="op">=</span> <span class="va">mask_mandate</span></span>
<span>  <span class="op">)</span>,</span>
<span>  scenario_05 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    contacts <span class="op">=</span> <span class="va">close_schools</span>,</span>
<span>    transmission_rate <span class="op">=</span> <span class="va">mask_mandate</span></span>
<span>  <span class="op">)</span>,</span>
<span>  scenario_06 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    contacts <span class="op">=</span> <span class="va">close_workplaces</span>,</span>
<span>    transmission_rate <span class="op">=</span> <span class="va">mask_mandate</span></span>
<span>  <span class="op">)</span>,</span>
<span>  scenario_07 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    contacts <span class="op">=</span> <span class="va">combined_intervention</span>,</span>
<span>    transmission_rate <span class="op">=</span> <span class="va">mask_mandate</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Note that</strong> there is no parameter uncertainty included
here. We can visualise the effect of each intervention set in the form
of the epidemic’s final size, aggregating over age groups.</p>
<p>The output is a nested <code>&lt;data.table&gt;</code> as before — we
can quickly get a table of the final epidemic sizes for each scenarios —
this is a key initial indicator of the effectiveness of
interventions.</p>
<div class="alert alert-info">
<p><strong>Note that</strong> in this example, we use the model’s
default
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
estimate of 1.3. This is because at higher values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>,
we get counter-intuitive results for the effects of interventions that
reduce transmission. This is explored in more detail later in this
vignette.</p>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pass the list of intervention sets to the model function</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_default.html">model_default</a></span><span class="op">(</span></span>
<span>  <span class="va">uk_population</span>,</span>
<span>  intervention <span class="op">=</span> <span class="va">intervention_scenarios</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">600</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># examine the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="co">#&gt;    transmission_rate infectiousness_rate recovery_rate time_end param_set</span></span>
<span><span class="co">#&gt;                &lt;num&gt;               &lt;num&gt;         &lt;num&gt;    &lt;num&gt;     &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:         0.1857143                 0.5     0.1428571      600         1</span></span>
<span><span class="co">#&gt; 2:         0.1857143                 0.5     0.1428571      600         1</span></span>
<span><span class="co">#&gt; 3:         0.1857143                 0.5     0.1428571      600         1</span></span>
<span><span class="co">#&gt; 4:         0.1857143                 0.5     0.1428571      600         1</span></span>
<span><span class="co">#&gt; 5:         0.1857143                 0.5     0.1428571      600         1</span></span>
<span><span class="co">#&gt; 6:         0.1857143                 0.5     0.1428571      600         1</span></span>
<span><span class="co">#&gt;         population intervention vaccination time_dependence increment scenario</span></span>
<span><span class="co">#&gt;             &lt;list&gt;       &lt;list&gt;      &lt;list&gt;          &lt;list&gt;     &lt;num&gt;    &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1: &lt;population[4]&gt;    &lt;list[1]&gt;      [NULL]       &lt;list[1]&gt;         1        1</span></span>
<span><span class="co">#&gt; 2: &lt;population[4]&gt;    &lt;list[1]&gt;      [NULL]       &lt;list[1]&gt;         1        2</span></span>
<span><span class="co">#&gt; 3: &lt;population[4]&gt;    &lt;list[1]&gt;      [NULL]       &lt;list[1]&gt;         1        3</span></span>
<span><span class="co">#&gt; 4: &lt;population[4]&gt;    &lt;list[1]&gt;      [NULL]       &lt;list[1]&gt;         1        4</span></span>
<span><span class="co">#&gt; 5: &lt;population[4]&gt;    &lt;list[2]&gt;      [NULL]       &lt;list[1]&gt;         1        5</span></span>
<span><span class="co">#&gt; 6: &lt;population[4]&gt;    &lt;list[2]&gt;      [NULL]       &lt;list[1]&gt;         1        6</span></span>
<span><span class="co">#&gt;                    data</span></span>
<span><span class="co">#&gt;                  &lt;list&gt;</span></span>
<span><span class="co">#&gt; 1: &lt;data.table[9015x4]&gt;</span></span>
<span><span class="co">#&gt; 2: &lt;data.table[9015x4]&gt;</span></span>
<span><span class="co">#&gt; 3: &lt;data.table[9015x4]&gt;</span></span>
<span><span class="co">#&gt; 4: &lt;data.table[9015x4]&gt;</span></span>
<span><span class="co">#&gt; 5: &lt;data.table[9015x4]&gt;</span></span>
<span><span class="co">#&gt; 6: &lt;data.table[9015x4]&gt;</span></span></code></pre></div>
</div>
<div class="section level3 alert alert-info">
<h3 id="output-type-for-list-intervention-inputs">Output type for list intervention inputs<a class="anchor" aria-label="anchor" href="#output-type-for-list-intervention-inputs"></a>
</h3>
<p>The output of <code>model_*()</code> when either
<code>intervention</code> or <code>vaccination</code> is passed a list,
is a nested <code>&lt;data.table&gt;</code>. This is similar to the
output type when parameters are passed as vectors, but with the
<code>"scenario"</code> column indicating each intervention set as a
distinct scenario, which helps with grouping the model outputs in
<code>"data"</code>.</p>
</div>
<p>The function <code><a href="../reference/epidemic_size.html">epidemic_size()</a></code> can be applied to the
nested data column <code>data</code> to get the final size for each
scenario.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set intervention labels</span></span>
<span><span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Close schools"</span>, <span class="st">"Close workplaces"</span>, <span class="st">"Close both"</span>,</span>
<span>  <span class="st">"Mask mandate"</span>, <span class="st">"Masks + close schools"</span>, <span class="st">"Masks + close workplaces"</span>,</span>
<span>  <span class="st">"Masks + close both"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">epidemic_size_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>  <span class="va">output</span>,</span>
<span>  scenario <span class="op">=</span> <span class="va">labels</span>,</span>
<span>  size <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">epidemic_size</span>, by_group <span class="op">=</span> <span class="cn">FALSE</span>, include_deaths <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">scenario</span>, <span class="va">size</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># view the final epidemic sizes</span></span>
<span><span class="va">epidemic_size_estimates</span></span>
<span><span class="co">#&gt;                    scenario       size</span></span>
<span><span class="co">#&gt;                      &lt;char&gt;     &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:            Close schools 21,506,900</span></span>
<span><span class="co">#&gt; 2:         Close workplaces 22,426,935</span></span>
<span><span class="co">#&gt; 3:               Close both  6,703,825</span></span>
<span><span class="co">#&gt; 4:             Mask mandate 22,713,914</span></span>
<span><span class="co">#&gt; 5:    Masks + close schools 17,267,407</span></span>
<span><span class="co">#&gt; 6: Masks + close workplaces 20,585,324</span></span>
<span><span class="co">#&gt; 7:       Masks + close both  2,082,890</span></span></code></pre></div>
<p>This example shows how implementing interventions that reduce
transmission can reduce the size of an epidemic.</p>
<div class="section level3 alert alert-info">
<h3 id="combinations-of-intervention-and-vaccination-scenarios">Combinations of intervention and vaccination scenarios<a class="anchor" aria-label="anchor" href="#combinations-of-intervention-and-vaccination-scenarios"></a>
</h3>
<p>When either or both <code>intervention</code> and
<code>vaccination</code> are passed as lists (of intervention sets, or
of vaccination regimes, respectively), the model is run for each
combination of elements. Thus for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
intervention sets and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
vaccination regimes, the model runs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>×</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">M \times N</annotation></semantics></math>
times, and each combination is treated as a unique scenario.</p>
<p><strong>Note that</strong> ‘no intervention’ and ‘no vaccination’
scenarios are not automatically created, and must be passed explicitly
as <code>NULL</code> in the respective lists.</p>
<p>While the number of intervention and vaccination combinations are not
expected to be very many, the addition of parameter uncertainty for each
scenario (next section) may rapidly multiply the number of times the
model is run. <strong>Users are advised</strong> to be mindful of the
number of scenario combinations they create.</p>
</div>
<p>The unnesting of the output follows the same procedure as before, and
is not shown here.</p>
<div class="section level2">
<h2 id="modelling-epidemic-response-scenarios-with-parameter-uncertainty">Modelling epidemic response scenarios with parameter
uncertainty<a class="anchor" aria-label="anchor" href="#modelling-epidemic-response-scenarios-with-parameter-uncertainty"></a>
</h2>
<p><em>epidemics</em> allows parameter uncertainty to be combined with
scenario models of multiple intervention sets or vaccination
campaigns.</p>
<p>Here, we shall draw 100 samples of the transmission rate with a mean
of 0 and a low standard deviation of 0.005.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span></span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1.3</span> <span class="op">/</span> <span class="fl">7</span>, <span class="fl">0.005</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this example includes 100 samples of transmission rates for each intervention</span></span>
<span><span class="co"># including the baseline</span></span>
<span><span class="va">scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_default.html">model_default</a></span><span class="op">(</span></span>
<span>  <span class="va">uk_population</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="va">beta</span>,</span>
<span>  intervention <span class="op">=</span> <span class="va">intervention_scenarios</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">600</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The output is a nested <code>&lt;data.table&gt;</code> as before, and
can be handled in the same way.</p>
<div class="section level3 alert alert-info">
<h3 id="output-type-for-intervention-and-parameter-set-combinations">Output type for intervention and parameter set combinations<a class="anchor" aria-label="anchor" href="#output-type-for-intervention-and-parameter-set-combinations"></a>
</h3>
<p>The output of <code>model_*()</code> when either
<code>intervention</code> or <code>vaccination</code> is passed a list,
and when any of the infection parameters is passed as a vector is a
nested <code>&lt;data.table&gt;</code>. The <code>"scenario"</code>
column indicates each intervention set as a distinct scenario, while the
<code>"param_set"</code> column indicates the parameter set used for the
model run.</p>
<p>The <strong>same parameters</strong> are used for each scenario,
allowing for comparability between scenarios at the aggregate level.</p>
<p>The output has
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>×</mo><mi>N</mi><mo>×</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">M \times N \times S</annotation></semantics></math>
rows (and nested model outputs), for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
intervention sets,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
vaccination regimes, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
infection parameter sets.</p>
</div>
<div class="section level3">
<h3 id="comparing-response-scenarios-with-parameter-uncertainty">Comparing response scenarios with parameter uncertainty<a class="anchor" aria-label="anchor" href="#comparing-response-scenarios-with-parameter-uncertainty"></a>
</h3>
<p>When running multiple scenarios with parameter uncertainty, there may
easily be hundreds of output rows corresponding to each scenario and
parameter set combination. This can become challenging to handle and
lead to comparisons that are not valid, such as across different
parameter sets.</p>
<div class="alert alert-info">
<p>The <code><a href="../reference/outcomes_averted.html">outcomes_averted()</a></code> function can help to quickly
calculate the differences in epidemic sizes between a baseline scenario
and any number of alternative or comparator scenarios. The function
ensures that alternative scenarios share the same characteristics, such
as infection parameters, with the baseline scenario. It also ensures
like-for-like comparisons between scenarios and the baselines by
matching output data from each scenario to its direct counterfactual in
the baseline, ensuring that the only differences in outcomes are due to
the implementation of interventions.</p>
</div>
<p>We re-use the transmission rate values drawn earlier to represent
uncertainty in this parameter.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run a baseline scenario with no epidemic response against which to compare</span></span>
<span><span class="co"># previously generated scenario data</span></span>
<span><span class="va">baseline</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_default.html">model_default</a></span><span class="op">(</span></span>
<span>  <span class="va">uk_population</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="va">beta</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">600</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We use <code><a href="../reference/outcomes_averted.html">outcomes_averted()</a></code> to calculate the total number
of cases averted across all demographic groups for each parameter
set.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">intervention_effect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/outcomes_averted.html">outcomes_averted</a></span><span class="op">(</span></span>
<span>  baseline <span class="op">=</span> <span class="va">baseline</span>, scenarios <span class="op">=</span> <span class="va">scenarios</span>,</span>
<span>  by_group <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  summarise <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot distribution of differences</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">intervention_effect</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">outcomes_averted</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">scenario</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">scenario</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/stat_histinterval.html" class="external-link">stat_histinterval</a></span><span class="op">(</span></span>
<span>    normalize <span class="op">=</span> <span class="st">"xy"</span>, breaks <span class="op">=</span> <span class="fl">11</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Scenario comparison"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Infections averted"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">labels</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/scale_colour_discrete_qualitative.html" class="external-link">scale_fill_discrete_qualitative</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"Dynamic"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="modelling_scenarios_files/figure-html/unnamed-chunk-13-1.png" alt="Infections averted relative to no epidemic response by implementing each scenario, while accounting with parameter uncertainty in the transmission rates." width="900"><p class="caption">
Infections averted relative to no epidemic response by implementing each
scenario, while accounting with parameter uncertainty in the
transmission rates.
</p>
</div>
<p>We can get more compact data suitable for tables by summarising the
output to get a summary of the median cases averted along with the 95%
uncertainty interval using the <code>summarise</code> argument, and we
can also disaggregate the cases averted by demographic group using the
<code>by_group</code> argument. Both these options are <code>TRUE</code>
by default.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/outcomes_averted.html">outcomes_averted</a></span><span class="op">(</span></span>
<span>  baseline <span class="op">=</span> <span class="va">baseline</span>, scenarios <span class="op">=</span> <span class="va">scenarios</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;     scenario demography_group averted_median averted_lower averted_upper</span></span>
<span><span class="co">#&gt;        &lt;int&gt;           &lt;char&gt;          &lt;num&gt;         &lt;num&gt;         &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:        1              40+       584725.9     145892.81     3993655.9</span></span>
<span><span class="co">#&gt;  2:        1           [0,20)       383171.0     127049.23     3037175.1</span></span>
<span><span class="co">#&gt;  3:        1          [20,40)       396356.0      98546.05     2932546.7</span></span>
<span><span class="co">#&gt;  4:        2              40+       261674.1     167791.23     2000556.2</span></span>
<span><span class="co">#&gt;  5:        2           [0,20)       158910.2      94722.94     1438610.6</span></span>
<span><span class="co">#&gt;  6:        2          [20,40)       204104.8     146675.38     1441537.8</span></span>
<span><span class="co">#&gt;  7:        3              40+      6320394.3    1475845.60     7616611.1</span></span>
<span><span class="co">#&gt;  8:        3           [0,20)      4678799.4     901966.59     6134652.6</span></span>
<span><span class="co">#&gt;  9:        3          [20,40)      4583922.8     985309.24     5716507.3</span></span>
<span><span class="co">#&gt; 10:        4              40+       177347.8     151125.36      871724.9</span></span>
<span><span class="co">#&gt; 11:        4           [0,20)       112115.4      96410.27      608345.6</span></span>
<span><span class="co">#&gt; 12:        4          [20,40)       118754.2     101979.46      617282.5</span></span>
<span><span class="co">#&gt; 13:        5              40+      2173081.3     305593.02     6258725.1</span></span>
<span><span class="co">#&gt; 14:        5           [0,20)      1442121.5     194790.14     5107124.7</span></span>
<span><span class="co">#&gt; 15:        5          [20,40)      1500221.3     200377.45     4737525.2</span></span>
<span><span class="co">#&gt; 16:        6              40+       932398.3     200154.87     4925179.7</span></span>
<span><span class="co">#&gt; 17:        6           [0,20)       592856.0     115273.86     3826790.4</span></span>
<span><span class="co">#&gt; 18:        6          [20,40)       639981.0     155689.23     3654849.3</span></span>
<span><span class="co">#&gt; 19:        7              40+      8012047.9    3959960.69     8348571.8</span></span>
<span><span class="co">#&gt; 20:        7           [0,20)      6246259.3    2586944.09     6633237.2</span></span>
<span><span class="co">#&gt; 21:        7          [20,40)      5916770.1    2716621.69     6232275.9</span></span>
<span><span class="co">#&gt;     scenario demography_group averted_median averted_lower averted_upper</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="counter-intuitive-effects-of-time-limited-interventions">Counter-intuitive effects of time-limited interventions<a class="anchor" aria-label="anchor" href="#counter-intuitive-effects-of-time-limited-interventions"></a>
</h2>
<p>The intervention scenarios modelled above suggest that:</p>
<ul>
<li><p>interventions on disease transmission rates reduce infections and
hence epidemic final sizes;</p></li>
<li><p>multiple interventions reduce epidemic final sizes more than
single interventions.</p></li>
</ul>
<p>In this simple example we show how this need not always be the case,
and that counter-intuitively, implementing more interventions can lead
to a larger epidemic final size than implementing fewer
interventions.</p>
<p>This phenomenon depends on the baseline transmission rate of the
infection, so we select a relatively low
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
of 1.30 (corresponding to pandemic influenza), and a higher
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
of 1.6 to illustrate the point.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run each scenario for two values of R</span></span>
<span><span class="co"># no parameter uncertainty</span></span>
<span><span class="va">r_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.3</span>, <span class="fl">1.6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_default.html">model_default</a></span><span class="op">(</span></span>
<span>  <span class="va">uk_population</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="va">r_values</span> <span class="op">/</span> <span class="fl">7</span>,</span>
<span>  intervention <span class="op">=</span> <span class="va">intervention_scenarios</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">600</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># obtain epidemic sizes</span></span>
<span><span class="va">epidemic_size_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>  <span class="va">output</span>,</span>
<span>  size <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span></span>
<span>    <span class="va">data</span>, <span class="va">epidemic_size</span>,</span>
<span>    by_group <span class="op">=</span> <span class="cn">FALSE</span>, include_deaths <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  r_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">r_values</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">intervention_scenarios</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">labels</span>, <span class="va">labels</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">r_value</span>, <span class="va">scenario</span>, <span class="va">size</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot the epidemic final size for each scenario for each R</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">epidemic_size_estimates</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">scenario</span>, <span class="va">size</span>, fill <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_axis.html" class="external-link">guide_axis</a></span><span class="op">(</span>n.dodge <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span>,</span>
<span>    name <span class="op">=</span> <span class="st">"Epidemic size"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/scale_colour_discrete_qualitative.html" class="external-link">scale_fill_discrete_qualitative</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"Dynamic"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">r_value</span><span class="op">)</span>,</span>
<span>    labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span></span>
<span>      r_value <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"R = %s"</span>, <span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="modelling_scenarios_files/figure-html/unnamed-chunk-16-1.png" alt="Counter-intuitive effects of time-limited interventions on transmission rate at high R values. Scenarios in which multiple interventions are implemented may have a larger final epidemic size than scenarios with fewer interventions, e.g. the 'Close both workplaces and schools' scenario." width="900"><p class="caption">
Counter-intuitive effects of time-limited interventions on transmission
rate at high R values. Scenarios in which multiple interventions are
implemented may have a larger final epidemic size than scenarios with
fewer interventions, e.g. the ‘Close both workplaces and schools’
scenario.
</p>
</div>
<p>Plotting the epidemic trajectories for each scenario for each value
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
gives a fuller picture of why we see this unexpected effect.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get new infections per day</span></span>
<span><span class="va">daily_incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>  <span class="va">output</span>,</span>
<span>  r_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">r_values</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">intervention_scenarios</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">labels</span>, <span class="va">labels</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  incidence_data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">new_infections</span>, by_group <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">scenario</span>, <span class="va">r_value</span>, <span class="va">incidence_data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">incidence_data</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">daily_incidence</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"rect"</span>,</span>
<span>    xmin <span class="op">=</span> <span class="va">time_begin</span>, xmax <span class="op">=</span> <span class="va">time_end</span>,</span>
<span>    ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"grey90"</span>, colour <span class="op">=</span> <span class="st">"grey"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">new_infections</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">r_value</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">TRUE</span>, linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_comma</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">1e-3</span>, suffix <span class="op">=</span> <span class="st">"K"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/scale_colour_discrete_qualitative.html" class="external-link">scale_colour_discrete_qualitative</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"Dynamic"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"R"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">scenario</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time since epidemic start"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"New infections"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="modelling_scenarios_files/figure-html/unnamed-chunk-18-1.png" alt="New daily infections in each intervention scenario for two values of R. The period in which interventions are active is shown by the area shaded in grey. No interventions are active in the 'No response' scenario." width="900"><p class="caption">
New daily infections in each intervention scenario for two values of R.
The period in which interventions are active is shown by the area shaded
in grey. No interventions are active in the ‘No response’ scenario.
</p>
</div>
<p>Implementing interventions on the disease transmission rate leads to
a ‘flattening of the curve’ (reduced daily incidence in comparison with
no response) while the interventions are active.</p>
<p>However, these cases are deferred rather than prevented entirely, and
in both scenarios this is seen as a shifting of the incidence curve to
the right (towards the end of the simulation period).</p>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
is low, the incidence curve begins to rise later than when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
is high (interventions applied to these epidemics actually miss the
projected peak of the epidemic, but still shift cases to the right).
Thus low
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
epidemics do not run their course by the time the simulation ends,
making is appear as though interventions have succeeded in averting
infections.</p>
<p>At higher
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>,
the peak of the projected incidence curve without interventions falls
within the intervention period, and thus all interventions reduce new
infections. In scenarios with multiple active interventions, a large
number of susceptibles remain uninfected, compared to scenarios with
fewer interventions. The former thus see higher incidence peaks, leading
to counter-intuitively larger final epidemic sizes.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-howerton2023" class="csl-entry">
Howerton, Emily, Lucie Contamin, Luke C. Mullany, Michelle Qin, Nicholas
G. Reich, Samantha Bents, Rebecca K. Borchering, et al. 2023.
<span>“Evaluation of the US COVID-19 Scenario Modeling Hub for Informing
Pandemic Response Under Uncertainty.”</span> <em>Nature
Communications</em> 14 (1): 7260. <a href="https://doi.org/10.1038/s41467-023-42680-x" class="external-link">https://doi.org/10.1038/s41467-023-42680-x</a>.
</div>
<div id="ref-prasad2023" class="csl-entry">
Prasad, Pragati V., Molly K. Steele, Carrie Reed, Lauren Ancel Meyers,
Zhanwei Du, Remy Pasco, Jorge A. Alfaro-Murillo, et al. 2023.
<span>“Multimodeling Approach to Evaluating the Efficacy of Layering
Pharmaceutical and Nonpharmaceutical Interventions for Influenza
Pandemics.”</span> <em>Proceedings of the National Academy of
Sciences</em> 120 (28): e2300590120. <a href="https://doi.org/10.1073/pnas.2300590120" class="external-link">https://doi.org/10.1073/pnas.2300590120</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pratik Gupte, Rosalind Eggo, Edwin Van Leeuwen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3. Theme provided by <a href="https://github.com/epiverse-trace/epiversetheme" class="external-link">epiversetheme</a> 0.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
